<!DOCTYPE html>
<html>
<head>
<script type="text/javascript" src="/test/path"></script>
<script type="text/javascript" src="/test/list/1"></script>
<script type="text/javascript" src="/test/list/2"></script>
<script type="text/javascript">window.gracenode={"jspath":"/test/path","list":["/test/list/1","/test/list/2"],"a":"A","b":"B","c":"/two","d":"日本語","e":"\"quoted\""};(function(window){vardomain=window.location.origin;/*expose*/window.request=request;/*options:{sendAsBinary:<boolean>,mimeType:<string>,headers:<object>}*/functionrequest(url,method,params,options,cb){url=domain+url;varreq;if(!params){params={};}if(!options){options={};}url=window.encodeURI(url);/*sadbutwehavetodealwithIE<7*/if(!window.XMLHttpRequest){/*sosomeoneisignorantenoughtobeuseIE...*/req=newwindow.ActiveXObject('Microsoft.XMLHTTP');}else{req=newwindow.XMLHttpRequest();}/*setuprequestparameters*/try{params=setupParams(params);}catch(exception){returncb(exception);}/*setuprequestobject*/req.overrideMimeType(options.mimeType||'text');req.open(method,url,true);/*defaultcontenttypeheader*/req.setRequestHeader('Content-Type','application/x-www-form-urlencoded');/*ifweneedtosendmoreheaders*/if(options.headers){for(varnameinoptions.headers){req.setRequestHeader(name,options.headers[name]);}}/*setupthelistener*/req.onreadystatechange=function(){handleResponse(req,cb);};/*nowsendtherequest*/if(options.sendAsBinary){returnreq.sendAsBinary(params);}req.send(params);}functionsetupParams(params){varstr='';for(varkeyinparams){if(str!==''){str+='&';}str+=window.encodeURIComponent(key)+'='+prepareParamValue(params[key]);}returnstr;}functionprepareParamValue(param){if(typeofparam==='object'){returnwindow.encodeURIComponent(JSON.stringify(param));}returnwindow.encodeURIComponent(param);}functionhandleResponse(req,cb){if(req.readyState===4){/*wenowhavetheresponseback*/varerror;varres=null;/*evaluateresponsestatuscode*/if(req.status>399){//errorerror=newError(req.status);}/*dealwithresponsebody*/if(req.responseText){/*isitaJSON?*/try{res=JSON.parse(req.responseText);}catch(e){/*itisnotaJSON*/res=req.responseText;}}cb(error,res,req.status);}}}(window));(function(){varTAGS={SRC:'data-gn-src',LOCAL:'data-gn-local'};varTAG_EXEC_MAP={};TAG_EXEC_MAP[TAGS.SRC]=getRemoteData;TAG_EXEC_MAP[TAGS.LOCAL]=getLocalData;document.EventListener('DOMContentLoaded',parse,false);window.render=function(target){parse(null,target);};functionparse(event,target){for(varkeyinTAGS){finder(TAGS[key],target);}}functionfinder(tagName,target){target=target||document;varlist=target.querySelectorAll('['+tagName+']')||[];varexec=TAG_EXEC_MAP[tagName];for(vari=0,len=list.length;i<len;i++){exec(list[i],tagName);}}functiongetRemoteData(elm,path){window.request(path,'GET',{},{},function(error,data){if(error){console.log(path,error);return;}vardom=buildDOM(data);elm.appendChild(dom);});}/*example:gracenode.myData*/functiongetLocalData(elm,str){varlist=str.split('.');vardata=window;for(vari=0,len=list.length;i<len;i++){data=data[list[i]];}if(!data||data===window){console.error(str,'InvalidLocalData');}vardom=buildDOM(data);elm.appendChild(dom);}functionbuildDOM(data){switch(typeofdata){case'object':if(Array.isArray(data)){returnbuildList(data);}returnbuildTwoColumnTable(data);default:returnbuildText(data);}}functionbuildList(data){varcontainer;vari;varlen;/*alistofmap=table*/if(typeofdata[0]==='object'){varrow;varlabels=[];container=document.createElement('table');container.className='list-table';/*tablelabels*/row=document.createElement('tr');for(i=0,len=data.length;i<len;i++){for(varnameindata[i]){if(labels.indexOf(data[i][name])!==-1){continue;}varth=document.createElement('th');th.textContent=data[i][name];row.appendChild(th);}}container.appendChild(row);/*tablerows*/for(i=0,len=data.length;i<len;i++){row=document.createElement('tr');vartd=document.createElement('td');content=buildDOM(data[i]);td.appendChild(td);row.appendChild(td);container.appendChild(row);}/*done*/returncontainer;}/*alistoftext=list*/container=document.createElement('ul');container.className='list-container';for(i=0,len=data.length;i<len;i++){varitem=document.createElement('li');item.appendChild(buildDOM(data[i]));container.appendChild(item);}/*done*/returncontainer;}functionbuildTwoColumnTable(data){varcontainer=document.createElement('table');container.className='two-col-table';for(varnameindata){varrow=document.createElement('tr');varlabel=document.createElement('th');label.textContent=name;row.appendChild(label);varvalue=document.createElement('td');value.appendChild(buildDOM(data[name]));row.appendChild(value);}returncontainer;}functionbuildText(data){varcontainer=document.createElement('div');container.className='text'+(typeofdata==='number'?'number':'');container.textContent=data;returncontainer;}}());</script>
</head>
<body>
<div class="whatever">Foo</div>
<div>Required!!</div>
<h2>Variable&nbsp;b&nbsp;is&nbsp;B</h2>
<div>0&nbsp;=&nbsp;/test/list/1</div><div>1&nbsp;=&nbsp;/test/list/2</div>
<div>Yay!</div>
<div>Yes&nbsp;it&nbsp;is&nbsp;else</div>
<div>require 2</div>
<div>0&nbsp;=&nbsp;/test/list/1</div><div>1&nbsp;=&nbsp;/test/list/2</div>


<h1>A&nbsp;is&nbsp;NOT&nbsp;B</h1>
<div>Required!!</div>
<h2>Variable&nbsp;b&nbsp;is&nbsp;B</h2>
<div>0&nbsp;=&nbsp;/test/list/1</div><div>1&nbsp;=&nbsp;/test/list/2</div>
<div>Yay!</div>
<div>Yes&nbsp;it&nbsp;is&nbsp;else</div>
<div>require 2</div>
<div>0&nbsp;=&nbsp;/test/list/1</div><div>1&nbsp;=&nbsp;/test/list/2</div>


<script type="text/javascript">
var list = [1,2,3,4,5,6,7,8,9];
for (var i = 0, len = list.length; i < len; i++) {
	console.log('yes ' + i);
}
</script>
<div>Test&nbsp;0</div><div>Test&nbsp;10</div><div>Test&nbsp;20</div><div>Test&nbsp;30</div><div>Test&nbsp;40</div><div>Test&nbsp;50</div><div>Test&nbsp;60</div><div>Test&nbsp;70</div><div>Test&nbsp;80</div><div>Test&nbsp;90</div><div>Test&nbsp;100</div>
<pre>
{
	a: A,
	b: B
}
</pre>
</body>
</html>
